<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Report Scheduler - CampaignPulse</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #8b5cf6, #a855f7); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .scheduler-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .scheduler-card { background: white; padding: 20px; border-radius: 8px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #8b5cf6; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; }
        button:hover { background: #7c3aed; }
        .frequency-tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #f3f4f6; border: none; cursor: pointer; border-radius: 4px 4px 0 0; margin-right: 2px; }
        .tab.active { background: #8b5cf6; color: white; }
        .schedule-options { background: #f8fafc; padding: 15px; border-radius: 4px; margin-bottom: 15px; }
        .day-selector { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-top: 10px; }
        .day-btn { padding: 8px; text-align: center; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; font-size: 12px; }
        .day-btn.selected { background: #8b5cf6; color: white; border-color: #8b5cf6; }
        .time-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .scheduled-list { background: white; padding: 20px; border-radius: 8px; }
        .schedule-item { display: flex; justify-content: between; align-items: center; padding: 15px; border: 1px solid #f3f4f6; border-radius: 4px; margin-bottom: 10px; }
        .schedule-info { flex: 1; }
        .schedule-name { font-weight: bold; margin-bottom: 5px; }
        .schedule-details { font-size: 12px; color: #6b7280; }
        .schedule-status { padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; margin-right: 10px; }
        .status-active { background: #dcfce7; color: #166534; }
        .status-scheduled { background: #dbeafe; color: #1e40af; }
        .next-run { font-size: 11px; color: #8b5cf6; font-weight: bold; }
        .preview-section { background: white; padding: 20px; border-radius: 8px; margin-top: 20px; }
        .preview-header { display: flex; justify-content: between; align-items: center; margin-bottom: 15px; }
        .report-preview { border: 1px solid #e5e7eb; border-radius: 4px; padding: 15px; background: #fafafa; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ“… Performance Report Scheduler</h1>
            <p>Schedule automated weekly and monthly performance reports with custom delivery options</p>
        </div>

        <div class="scheduler-grid">
            <div class="scheduler-card">
                <h2>Schedule Performance Report</h2>
                
                <div class="frequency-tabs">
                    <button class="tab active" onclick="switchTab('weekly')">Weekly</button>
                    <button class="tab" onclick="switchTab('monthly')">Monthly</button>
                </div>

                <form id="scheduleForm">
                    <div class="form-group">
                        <label>Report Name</label>
                        <input type="text" id="reportName" placeholder="Weekly Performance Summary" required>
                    </div>

                    <div class="schedule-options" id="weeklyOptions">
                        <h4>Weekly Schedule</h4>
                        <label>Delivery Day</label>
                        <div class="day-selector">
                            <div class="day-btn" data-day="1">Mon</div>
                            <div class="day-btn" data-day="2">Tue</div>
                            <div class="day-btn" data-day="3">Wed</div>
                            <div class="day-btn" data-day="4">Thu</div>
                            <div class="day-btn" data-day="5">Fri</div>
                            <div class="day-btn" data-day="6">Sat</div>
                            <div class="day-btn" data-day="0">Sun</div>
                        </div>
                    </div>

                    <div class="schedule-options" id="monthlyOptions" style="display: none;">
                        <h4>Monthly Schedule</h4>
                        <div class="time-grid">
                            <div>
                                <label>Delivery Date</label>
                                <select id="monthlyDate">
                                    <option value="1">1st of month</option>
                                    <option value="5">5th of month</option>
                                    <option value="15">15th of month</option>
                                    <option value="last">Last day of month</option>
                                </select>
                            </div>
                            <div>
                                <label>Report Period</label>
                                <select id="reportPeriod">
                                    <option value="previous">Previous month</option>
                                    <option value="current">Current month</option>
                                    <option value="quarter">Quarterly</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Delivery Time</label>
                        <input type="time" id="deliveryTime" value="09:00">
                    </div>

                    <div class="form-group">
                        <label>Recipients</label>
                        <textarea id="recipients" placeholder="manager@company.com, team@company.com" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Report Format</label>
                        <select id="reportFormat">
                            <option value="pdf">PDF Report</option>
                            <option value="excel">Excel Spreadsheet</option>
                            <option value="html">HTML Dashboard</option>
                            <option value="all">All Formats</option>
                        </select>
                    </div>

                    <button type="submit">Schedule Report</button>
                    <button type="button" onclick="previewReport()">Preview Report</button>
                </form>
            </div>

            <div class="scheduler-card">
                <h2>Quick Schedule Templates</h2>
                <div style="margin-bottom: 15px;">
                    <button onclick="loadTemplate('executive-weekly')" style="width: 100%; margin-bottom: 10px;">Executive Weekly Summary</button>
                    <button onclick="loadTemplate('team-weekly')" style="width: 100%; margin-bottom: 10px;">Team Weekly Performance</button>
                    <button onclick="loadTemplate('monthly-roi')" style="width: 100%; margin-bottom: 10px;">Monthly ROI Analysis</button>
                    <button onclick="loadTemplate('quarterly-review')" style="width: 100%; margin-bottom: 10px;">Quarterly Business Review</button>
                </div>

                <h3>Schedule Summary</h3>
                <div id="scheduleSummary" style="background: #f8fafc; padding: 15px; border-radius: 4px; font-size: 14px;">
                    <p>No report scheduled yet. Configure options above to see summary.</p>
                </div>
            </div>
        </div>

        <div class="scheduled-list">
            <h2>Scheduled Performance Reports</h2>
            <div id="scheduledReports"></div>
        </div>

        <div class="preview-section">
            <div class="preview-header">
                <h2>Report Preview</h2>
                <div>
                    <button onclick="sendTestReport()">Send Test Report</button>
                    <button onclick="generateNow()">Generate Now</button>
                </div>
            </div>
            <div class="report-preview" id="reportPreview">
                <h3>Weekly Performance Report - Sample</h3>
                <p><strong>Period:</strong> Dec 25 - Dec 31, 2023</p>
                <p><strong>Generated:</strong> Jan 1, 2024 at 9:00 AM</p>
                <hr style="margin: 15px 0;">
                <h4>Executive Summary</h4>
                <ul>
                    <li>Total Clicks: 15,420 (+12% vs last week)</li>
                    <li>Conversions: 342 (+8% vs last week)</li>
                    <li>Revenue: $18,650 (+15% vs last week)</li>
                    <li>ROI: 145% (+5% vs last week)</li>
                </ul>
                <h4>Top Performing Campaigns</h4>
                <ul>
                    <li>Email Newsletter: 220% ROI</li>
                    <li>Google Ads - Black Friday: 185% ROI</li>
                    <li>Facebook Holiday Sale: 142% ROI</li>
                </ul>
                <h4>Recommendations</h4>
                <ul>
                    <li>Scale email campaign budget by 30%</li>
                    <li>Optimize LinkedIn targeting for better ROI</li>
                    <li>A/B test Instagram ad creatives</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'weekly';
        let selectedDay = null;
        let scheduledReports = [
            {
                id: 1,
                name: 'Executive Weekly Summary',
                frequency: 'weekly',
                day: 1,
                time: '09:00',
                recipients: ['ceo@company.com', 'cmo@company.com'],
                format: 'pdf',
                status: 'active',
                nextRun: '2024-01-08 09:00'
            },
            {
                id: 2,
                name: 'Monthly ROI Analysis',
                frequency: 'monthly',
                date: 1,
                time: '10:00',
                recipients: ['finance@company.com'],
                format: 'excel',
                status: 'scheduled',
                nextRun: '2024-02-01 10:00'
            }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            setupDaySelector();
            setupForm();
            displayScheduledReports();
            updateScheduleSummary();
        });

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            document.getElementById('weeklyOptions').style.display = tab === 'weekly' ? 'block' : 'none';
            document.getElementById('monthlyOptions').style.display = tab === 'monthly' ? 'block' : 'none';
            
            updateScheduleSummary();
        }

        function setupDaySelector() {
            document.querySelectorAll('.day-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedDay = btn.dataset.day;
                    updateScheduleSummary();
                });
            });
        }

        function setupForm() {
            document.getElementById('scheduleForm').addEventListener('submit', (e) => {
                e.preventDefault();
                scheduleReport();
            });

            // Update summary when form changes
            ['reportName', 'deliveryTime', 'recipients', 'reportFormat', 'monthlyDate', 'reportPeriod'].forEach(id => {
                document.getElementById(id).addEventListener('change', updateScheduleSummary);
            });
        }

        function updateScheduleSummary() {
            const name = document.getElementById('reportName').value || 'Untitled Report';
            const time = document.getElementById('deliveryTime').value || '09:00';
            const format = document.getElementById('reportFormat').value || 'pdf';
            
            let scheduleText = '';
            
            if (currentTab === 'weekly') {
                const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
                const dayName = selectedDay !== null ? dayNames[selectedDay] : 'No day selected';
                scheduleText = `Every ${dayName} at ${time}`;
            } else {
                const date = document.getElementById('monthlyDate').value || '1';
                const period = document.getElementById('reportPeriod').value || 'previous';
                const dateText = date === 'last' ? 'last day' : `${date}${getOrdinalSuffix(date)}`;
                scheduleText = `${dateText} of each month at ${time}`;
            }

            document.getElementById('scheduleSummary').innerHTML = `
                <p><strong>Report:</strong> ${name}</p>
                <p><strong>Schedule:</strong> ${scheduleText}</p>
                <p><strong>Format:</strong> ${format.toUpperCase()}</p>
                <p><strong>Next Run:</strong> ${calculateNextRun()}</p>
            `;
        }

        function getOrdinalSuffix(num) {
            const j = num % 10;
            const k = num % 100;
            if (j == 1 && k != 11) return 'st';
            if (j == 2 && k != 12) return 'nd';
            if (j == 3 && k != 13) return 'rd';
            return 'th';
        }

        function calculateNextRun() {
            const time = document.getElementById('deliveryTime').value || '09:00';
            const now = new Date();
            let nextRun = new Date();

            if (currentTab === 'weekly' && selectedDay !== null) {
                const currentDay = now.getDay();
                const targetDay = parseInt(selectedDay);
                let daysUntil = targetDay - currentDay;
                if (daysUntil <= 0) daysUntil += 7;
                
                nextRun.setDate(now.getDate() + daysUntil);
            } else if (currentTab === 'monthly') {
                const date = document.getElementById('monthlyDate').value || '1';
                if (date === 'last') {
                    nextRun = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                } else {
                    nextRun.setDate(parseInt(date));
                    if (nextRun <= now) {
                        nextRun.setMonth(nextRun.getMonth() + 1);
                    }
                }
            }

            const [hours, minutes] = time.split(':');
            nextRun.setHours(parseInt(hours), parseInt(minutes), 0, 0);

            return nextRun.toLocaleDateString() + ' at ' + nextRun.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        function scheduleReport() {
            const name = document.getElementById('reportName').value;
            const time = document.getElementById('deliveryTime').value;
            const recipients = document.getElementById('recipients').value.split(',').map(r => r.trim());
            const format = document.getElementById('reportFormat').value;

            if (currentTab === 'weekly' && selectedDay === null) {
                alert('Please select a delivery day for weekly reports');
                return;
            }

            const newReport = {
                id: scheduledReports.length + 1,
                name,
                frequency: currentTab,
                day: currentTab === 'weekly' ? selectedDay : null,
                date: currentTab === 'monthly' ? document.getElementById('monthlyDate').value : null,
                period: currentTab === 'monthly' ? document.getElementById('reportPeriod').value : null,
                time,
                recipients,
                format,
                status: 'scheduled',
                nextRun: calculateNextRun(),
                createdAt: new Date().toISOString()
            };

            scheduledReports.push(newReport);
            displayScheduledReports();
            
            // Reset form
            document.getElementById('scheduleForm').reset();
            document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('selected'));
            selectedDay = null;
            updateScheduleSummary();

            alert(`Performance report "${name}" scheduled successfully!`);
        }

        function displayScheduledReports() {
            const container = document.getElementById('scheduledReports');
            
            if (scheduledReports.length === 0) {
                container.innerHTML = '<p>No performance reports scheduled yet.</p>';
                return;
            }

            container.innerHTML = scheduledReports.map(report => {
                const scheduleText = report.frequency === 'weekly' 
                    ? `Every ${['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'][report.day]} at ${report.time}`
                    : `${report.date}${getOrdinalSuffix(report.date)} of month at ${report.time}`;

                return `
                    <div class="schedule-item">
                        <div class="schedule-info">
                            <div class="schedule-name">${report.name}</div>
                            <div class="schedule-details">
                                ${scheduleText} â€¢ ${report.format.toUpperCase()} â€¢ ${report.recipients.length} recipient(s)
                            </div>
                            <div class="next-run">Next: ${report.nextRun}</div>
                        </div>
                        <div class="schedule-status ${report.status === 'active' ? 'status-active' : 'status-scheduled'}">
                            ${report.status.toUpperCase()}
                        </div>
                        <div>
                            <button onclick="toggleReport(${report.id})" style="font-size: 11px; padding: 5px 10px;">
                                ${report.status === 'active' ? 'Pause' : 'Activate'}
                            </button>
                            <button onclick="deleteSchedule(${report.id})" style="font-size: 11px; padding: 5px 10px; background: #dc2626;">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadTemplate(template) {
            const templates = {
                'executive-weekly': {
                    name: 'Executive Weekly Summary',
                    frequency: 'weekly',
                    day: 1,
                    time: '09:00',
                    recipients: 'ceo@company.com, cmo@company.com',
                    format: 'pdf'
                },
                'team-weekly': {
                    name: 'Team Weekly Performance',
                    frequency: 'weekly',
                    day: 5,
                    time: '17:00',
                    recipients: 'team@company.com, manager@company.com',
                    format: 'html'
                },
                'monthly-roi': {
                    name: 'Monthly ROI Analysis',
                    frequency: 'monthly',
                    date: '1',
                    time: '10:00',
                    recipients: 'finance@company.com, cfo@company.com',
                    format: 'excel'
                },
                'quarterly-review': {
                    name: 'Quarterly Business Review',
                    frequency: 'monthly',
                    date: '1',
                    time: '14:00',
                    recipients: 'executives@company.com',
                    format: 'all'
                }
            };

            const config = templates[template];
            if (!config) return;

            document.getElementById('reportName').value = config.name;
            document.getElementById('deliveryTime').value = config.time;
            document.getElementById('recipients').value = config.recipients;
            document.getElementById('reportFormat').value = config.format;

            if (config.frequency === 'weekly') {
                switchTab('weekly');
                selectedDay = config.day;
                document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('selected'));
                document.querySelector(`[data-day="${config.day}"]`).classList.add('selected');
            } else {
                switchTab('monthly');
                document.getElementById('monthlyDate').value = config.date;
            }

            updateScheduleSummary();
        }

        function toggleReport(id) {
            const report = scheduledReports.find(r => r.id === id);
            if (report) {
                report.status = report.status === 'active' ? 'scheduled' : 'active';
                displayScheduledReports();
            }
        }

        function deleteSchedule(id) {
            if (confirm('Delete this scheduled report?')) {
                scheduledReports = scheduledReports.filter(r => r.id !== id);
                displayScheduledReports();
            }
        }

        function previewReport() {
            alert('Generating report preview with current data...');
        }

        function sendTestReport() {
            const recipients = document.getElementById('recipients').value;
            if (!recipients) {
                alert('Please enter recipients first');
                return;
            }
            alert(`Test report will be sent to: ${recipients}`);
        }

        function generateNow() {
            alert('Generating performance report with latest data...');
        }
    </script>
</body>
</html>